/*
    uberSpark code bridges json definition
*/
{
		"uberspark.manifest.namespace": [
			"uberspark-bridge-cc"
		],
		"uberspark.manifest.version_min": "any",
		"uberspark.manifest.version_max": "any",

	"uberspark-bridge-cc": {
		/* bridge header */
		"bridge-hdr": {
			"category": "container",
			"name": "compcert",
			"executable_name": "ccomp",
			"dev_environment": "amd64",
			"arch": "x86_32",
			"cpu": "generic",
			"version": "v3.1",
			"path": ".",
			"parameters": [
				"-fpacked-structs",
				"-fstruct-passing",
				"-Wno-c11-extensions"
			],
			"container_filename": "uberspark_bridges.Dockerfile"
		},

		"bridge_cmd" : [
			"export var_bridge_include_dirs_with_prefix",
			"export var_bridge_input_files",
			"var_bridge_include_dirs_with_prefix=\" @@BRIDGE_INCLUDE_DIRS_WITH_PREFIX@@ \"",
			"var_bridge_input_files=\" @@BRIDGE_INPUT_FILES@@ \"",
			"vararray_bridge_input_files=$(echo $var_bridge_input_files | tr \" \" \"\\n\")",
			"for input_file_name in $vararray_bridge_input_files; do echo \"Compiling ${input_file_name} ...\" && ccomp @@BRIDGE_DEFS_WITH_PREFIX@@ -Wno-c11-extensions -fstruct-passing -fpacked-structs -c ${var_bridge_include_dirs_with_prefix} ${input_file_name} -o ${input_file_name}.o ; done",
			"cp -f /usr/local/lib/compcert/libcompcert.a @@BRIDGE_CONTAINER_MOUNT_POINT@@/cclib.a"
		] 

	}
}